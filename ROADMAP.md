# 嫁接日誌開發路線圖 (Development Roadmap)

## 📋 階段規劃總覽

| 階段 | 名稱 | 目標 | 狀態 |
|------|------|------|------|
| Phase 1 | MVP - 基本記錄功能 | 完成核心日誌記錄與人力管理 | ✅ **已完成** |
| Phase 2 | 成本追蹤、提醒系統 | 強化成本管理與作業提醒 | 📋 規劃中 |
| Phase 3 | 統計分析、報表 | 數據視覺化與決策支援 | 📋 規劃中 |
| Phase 4 | 進階功能 | AI 輔助與雲端同步 | 📋 規劃中 |

---

## ✅ Phase 1: MVP - 基本記錄功能 (已完成)

### 目標
建立核心的日誌記錄系統，實現離線優先的基本功能。

### 已完成功能
- [x] 專案管理（年度、品種、工資設定）
- [x] 每日日誌記錄（日期、區域、天候、人力）
- [x] 自動人工成本計算
- [x] 快速填報矩陣（藥劑、營養劑、肥料、調節劑）
- [x] 複製前一天功能
- [x] 本地 SQLite 資料庫
- [x] Material 3 UI
- [x] 跨平台支援（Windows/Android/iOS）

### 技術架構
- Flutter 3.35.3
- Riverpod 2.6.1
- Drift (SQLite)
- Material 3

---

## 📋 Phase 2: 成本追蹤、提醒系統

### 目標
強化成本管理能力，增加智慧提醒與花苞追蹤功能。

### 預計完成時間
2-3 週

### 功能清單

#### 2.1 花苞批次管理 🌸
- [ ] 花苞出庫登記
  - 批次編號
  - 出庫日期
  - 數量
  - 供應商（可選）
- [ ] 花苞與日誌關聯
  - 選擇使用的花苞批次
  - 自動計算天數差（出庫日 → 嫁接日）
- [ ] 花苞庫存追蹤
  - 剩餘數量顯示
  - 低庫存警告

#### 2.2 成本追蹤強化 💰
- [ ] 材料成本記錄
  - 花苞成本
  - 藥劑成本
  - 其他材料成本
- [ ] 每日總成本計算
  - 人工成本 + 材料成本
- [ ] 累計成本統計
  - 專案總成本
  - 平均每日成本
  - 成本趨勢圖（簡易）
- [ ] 成本預算功能
  - 設定預算上限
  - 預算使用百分比提示
  - 超預算警告

#### 2.3 提醒系統 ⏰
- [ ] 每日作業提醒
  - 設定提醒時間
  - 推播通知（需要權限）
- [ ] 關鍵日期提醒
  - 嫁接開始日
  - 預計完成日（第 30 日）
  - 重要觀察日（自訂）
- [ ] 天候警示
  - 連續雨天警告
  - 低溫警告（需手動輸入溫度）
- [ ] 作業檢查清單
  - 今日待辦項目
  - 逾期未記錄提醒

#### 2.4 資料備份/還原 💾
- [ ] 匯出資料庫檔案
- [ ] 從備份還原
- [ ] 自動備份（本地）
- [ ] 匯出 CSV 格式

### 技術需求
- 本地通知套件（flutter_local_notifications）
- 檔案選擇器（file_picker）
- CSV 處理（csv）
- 日期時間處理強化

### UI/UX 改進
- 成本儀表板頁面
- 提醒設定頁面
- 花苞庫存管理頁面
- 統計卡片（首頁顯示）

---

## 📊 Phase 3: 統計分析、報表

### 目標
提供深入的數據分析與專業報表輸出，支援決策制定。

### 預計完成時間
3-4 週

### 功能清單

#### 3.1 統計分析 📈
- [ ] 成功率追蹤
  - 黑頭率統計
  - 萌芽率統計
  - 展葉率統計
  - 按區域/天候分組分析
- [ ] 人力效率分析
  - 每人平均嫁接數
  - 工時分布
  - 效率趨勢
- [ ] 天候影響分析
  - 不同天候下的成功率
  - 天候與成本關聯
  - 最佳作業天候建議
- [ ] 時間序列分析
  - 進度曲線（16-30 天）
  - 日期 vs 完成度
  - 預測完成日期

#### 3.2 視覺化圖表 📊
- [ ] 圖表類型
  - 折線圖（成本趨勢、進度）
  - 圓餅圖（施作項目分布）
  - 長條圖（每日人力、成本比較）
  - 熱力圖（區域 × 天候成功率）
- [ ] 互動式圖表
  - 點擊查看詳細資料
  - 日期範圍篩選
  - 多專案對比
- [ ] 儀表板
  - 首頁摘要卡片
  - 專屬統計頁面
  - 可自訂顯示項目

#### 3.3 報表匯出 📄
- [ ] Excel (XLSX) 匯出
  - 日誌詳細資料表
  - 成本統計表
  - 人力統計表
  - 多工作表支援
  - 格式化（標題、顏色、邊框）
- [ ] PDF 報表
  - 專案總結報表
  - 成本分析報表
  - 包含圖表與表格
- [ ] 產銷履歷格式
  - 符合農委會規範
  - 可直接提交的格式
  - 包含追溯資訊
- [ ] 自訂報表範本
  - 選擇欄位
  - 調整排版
  - 儲存範本

#### 3.4 資料篩選與搜尋 🔍
- [ ] 進階篩選
  - 日期範圍
  - 區域
  - 天候
  - 人力範圍
  - 成本範圍
- [ ] 關鍵字搜尋
  - 區域名稱
  - 施作項目
- [ ] 排序功能
  - 日期、成本、人力等
- [ ] 儲存篩選條件

#### 3.5 狀態追蹤系統 🌱
- [ ] 接穗狀態記錄
  - 黑頭
  - 休眠
  - 萌芽
  - 展葉
- [ ] 狀態時間軸
  - 記錄狀態變化時間
  - 視覺化顯示
- [ ] 成功率自動計算
  - 按階段統計
  - 區域對比
- [ ] 異常追蹤
  - 失敗原因記錄
  - 失敗率分析

### 技術需求
- 圖表庫（fl_chart 或 syncfusion_flutter_charts）
- Excel 處理（excel）
- PDF 生成（pdf, printing）
- 資料分析計算

### UI/UX 改進
- 統計頁面
- 圖表頁面
- 報表預覽
- Windows 端優化（大螢幕佈局）

---

## 🚀 Phase 4: 進階功能（AI、雲端同步）

### 目標
引入智慧化功能與雲端服務，提升使用體驗與協作能力。

### 預計完成時間
4-6 週

### 功能清單

#### 4.1 AI 輔助功能 🤖
- [ ] 智慧預測
  - 成功率預測（基於歷史資料）
  - 完成時間預測
  - 成本預測
- [ ] 異常檢測
  - 偵測異常低的成功率
  - 成本異常警示
  - 人力配置建議
- [ ] 智慧建議
  - 最佳嫁接時間建議
  - 人力配置優化建議
  - 天候影響提示
- [ ] 圖像識別（進階）
  - 上傳照片自動判斷狀態
  - 病蟲害識別
  - 生長進度評估

#### 4.2 相簿對比功能 📷
- [ ] 照片管理
  - 按日誌上傳照片
  - 自動分類（區域 + 第 n 日）
  - 標籤系統
- [ ] 對比功能
  - 同區域不同天數對比
  - 不同區域同天數對比
  - 時間軸瀏覽
- [ ] 照片標註
  - 狀態標記
  - 問題標註
  - 文字註解
- [ ] 壓縮與快取
  - 自動壓縮節省空間
  - 本地快取加速

#### 4.3 雲端同步 ☁️
- [ ] 雲端備份
  - Firebase / Supabase
  - 自動同步
  - 版本控制
- [ ] 多裝置同步
  - 手機 ↔ 平板
  - 行動裝置 ↔ 電腦
  - 即時同步或手動觸發
- [ ] 離線支援
  - 無網路時本地操作
  - 恢復網路後自動同步
  - 衝突解決機制
- [ ] 帳號系統
  - 使用者註冊/登入
  - 多專案管理
  - 權限控制

#### 4.4 協作功能 👥
- [ ] 多使用者支援
  - 邀請成員加入專案
  - 角色權限（管理員、編輯者、檢視者）
- [ ] 評論與標註
  - 對日誌添加評論
  - @提及成員
  - 討論串
- [ ] 活動記錄
  - 誰在何時做了什麼
  - 審計軌跡
- [ ] 通知系統
  - 成員活動通知
  - 評論回覆通知

#### 4.5 進階設定 ⚙️
- [ ] 自訂欄位
  - 使用者自訂資料欄位
  - 靈活的表單設計
- [ ] 範本管理
  - 日誌範本
  - 專案範本
  - 快速建立
- [ ] 深色模式
  - 主題切換
  - 自動跟隨系統
- [ ] 多語言支援
  - 繁體中文
  - 英文
  - 其他語言（未來）
- [ ] 資料匯入
  - 從 Excel 匯入
  - 從其他系統遷移

#### 4.6 第三方整合 🔗
- [ ] 氣象 API
  - 自動獲取天候資料
  - 溫度、濕度、降雨
  - 未來天氣預報
- [ ] 行事曆整合
  - 同步至 Google Calendar
  - 提醒事項同步
- [ ] 通訊整合
  - LINE 通知
  - Email 報表

### 技術需求
- 機器學習（tflite_flutter）
- 影像處理（image, image_picker）
- Firebase / Supabase
- API 串接
- WebSocket（即時同步）

### UI/UX 改進
- 相簿瀏覽器
- 雲端同步狀態指示
- 深色模式全面支援
- 平板電腦最佳化佈局

---

## 🎯 優先級建議

### 高優先級（Phase 2 必做）
1. 花苞批次管理（核心業務需求）
2. 材料成本記錄（完整成本追蹤）
3. 資料備份/還原（資料安全）
4. 每日作業提醒（提升使用率）

### 中優先級（Phase 2-3）
1. 成本預算功能
2. Excel 匯出
3. 基本統計圖表
4. 狀態追蹤系統

### 低優先級（Phase 3-4）
1. 產銷履歷格式
2. PDF 報表
3. 進階圖表
4. 相簿對比

### 未來考慮（Phase 4）
1. AI 功能
2. 雲端同步
3. 協作功能
4. 第三方整合

---

## 📅 時間軸估算

```
Phase 1 (MVP)          ✅ 已完成
│
├─ Phase 2 開發        📋 2-3 週
│  ├─ 花苞批次管理     5 天
│  ├─ 成本追蹤強化     5 天
│  ├─ 提醒系統         3 天
│  └─ 資料備份         2 天
│
├─ Phase 3 開發        📋 3-4 週
│  ├─ 統計分析         7 天
│  ├─ 視覺化圖表       7 天
│  ├─ 報表匯出         5 天
│  └─ 狀態追蹤         3 天
│
└─ Phase 4 開發        📋 4-6 週
   ├─ AI 輔助功能      10 天
   ├─ 相簿對比         5 天
   ├─ 雲端同步         7 天
   └─ 協作功能         8 天

總計：約 3-4 個月完整開發週期
```

---

## 🔄 迭代策略

### 每個 Phase 結束後
1. 用戶測試與回饋收集
2. Bug 修復與優化
3. 文件更新
4. 版本發布

### 持續改進
- 定期收集用戶反饋
- 根據實際使用調整優先級
- 小步快跑，持續迭代

---

## 📝 下一步行動

### 立即行動（本週）
1. ✅ 完成 MVP 測試
2. 收集用戶初步反饋
3. 確認 Phase 2 具體需求

### 短期目標（2 週內）
1. 開始 Phase 2 開發
2. 優先實現花苞批次管理
3. 完成成本追蹤強化

### 中期目標（1-2 個月）
1. 完成 Phase 2
2. 開始 Phase 3 統計分析
3. 持續優化 UI/UX

---

## 🤝 需要決策的問題

1. **Phase 2 優先級確認**
   - 花苞批次管理 vs 提醒系統，哪個更急迫？

2. **雲端同步需求**
   - 是否需要多裝置同步？
   - 預算與技術可行性？

3. **AI 功能範圍**
   - 簡單預測 vs 深度學習？
   - 投資報酬率評估？

4. **報表格式**
   - 產銷履歷的具體規範？
   - 是否有範本可參考？

---

**備註**: 此路線圖為規劃文件，實際開發會根據反饋與資源調整。
